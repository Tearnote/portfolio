<div class="project">
    <p>{{ project.name }}</p>
    <p>Description: {{ project.description }}</p>
    <p>Reference code: {{ project.uuid }}</p>
    <p>
        {# The if needs to be on the same line to avoid a space before the comma #}
        Status: {{ project.get_status_display }}{% if project.status == project.PAYABLE %},
            &euro;{{ project.quote_amount }}
        {% endif %}
    </p>
    <div class="actions">
        {% if is_owner %}
            {% if project.status == project.NEW %}
                <form method="POST" action="#">
                    {% csrf_token %}
                    <label>
                        Amount:
                        <input type="number" name="quote_amount">
                    </label>
                    <input type="submit" value="Set quote">
                </form>
                <a role="button" href="#">Reject</a>
            {% endif %}
            {% if project.status == project.PAYABLE or project.status == project.IN_PROGRESS %}
                <form method="POST" action="{% url 'cancel_project' %}">
                    {% csrf_token %}
                    <input type="hidden" name="projectId" value="{{ project.id }}">
                    <input type="submit" value="Cancel" onclick="confirmProjectCancel(event)">
                </form>
            {% endif %}
            {% if project.status == project.IN_PROGRESS %}
                <a role="button" href="#">Mark completed</a>
            {% endif %}
        {% else %}
            {% if project.status == project.PAYABLE %}
                <a role="button" href="#">Pay now</a>
            {% endif %}
            {% if project.status == project.NEW or project.status == project.PAYABLE %}
                <form method="POST" action="{% url 'cancel_project' %}">
                    {% csrf_token %}
                    <input type="hidden" name="projectId" value="{{ project.id }}">
                    <input type="submit" value="Cancel" onclick="confirmProjectCancel(event)">
                </form>
            {% endif %}
            {% if project.status == project.COMPLETED %}
                <a role="button" href="#">Leave testimonial</a>
            {% endif %}
        {% endif %}
    </div>
</div>

{# Basic confirmation dialog scripts #}
<script>
    function confirmProjectCancel(event) {
        if (!confirm(
            "Are you sure you want to cancel the project?" +
            " The effect is immediate and cannot be undone."
        ))
            event.preventDefault();
    }
</script>
